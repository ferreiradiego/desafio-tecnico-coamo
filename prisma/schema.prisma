generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Classificacao {
  A
  B
  C
}

enum TipoCooperado {
  PF
  PJ
}

enum GrupoProduto {
  Fertilizantes
  Corretivos
  Herbicidas
  Fungicidas
  Inseticidas
}

model Unidade {
  unidade_id Int     @id @default(autoincrement())
  nome       String
  municipio  String
  Venda      Venda[]
}

model Cooperado {
  cooperado_id            Int                      @id @default(autoincrement())
  nome                    String
  classificacao           Classificacao
  tipo                    TipoCooperado
  CooperadoPessoaFisica   CooperadoPessoaFisica?
  CooperadoPessoaJuridica CooperadoPessoaJuridica?
  Venda                   Venda[]
}

model CooperadoPessoaFisica {
  cooperado_id    Int       @id
  cpf             String
  rg              String
  estado_civil    String
  data_nascimento DateTime
  Cooperado       Cooperado @relation(fields: [cooperado_id], references: [cooperado_id])
}

model CooperadoPessoaJuridica {
  cooperado_id  Int       @id
  data_fundacao DateTime
  Cooperado     Cooperado @relation(fields: [cooperado_id], references: [cooperado_id])
  Socio         Socio[]
}

model Socio {
  socio_id                Int                     @id @default(autoincrement())
  cooperado_juridico_id   Int
  nome                    String
  nacionalidade           String
  CooperadoPessoaJuridica CooperadoPessoaJuridica @relation(fields: [cooperado_juridico_id], references: [cooperado_id])
}

model Produto {
  produto_id     Int          @id @default(autoincrement())
  nome_comercial String
  formula        String
  unidade_medida String
  grupo          GrupoProduto
  ItemVenda      ItemVenda[]
}

model Venda {
  venda_id     Int         @id @default(autoincrement())
  cooperado_id Int
  unidade_id   Int
  data_venda   DateTime
  Cooperado    Cooperado   @relation(fields: [cooperado_id], references: [cooperado_id])
  Unidade      Unidade     @relation(fields: [unidade_id], references: [unidade_id])
  ItemVenda    ItemVenda[]
}

model ItemVenda {
  item_id        Int     @id @default(autoincrement())
  venda_id       Int
  produto_id     Int
  quantidade     Int
  preco_unitario Float
  desconto       Float
  icms_aplicado  Float
  Venda          Venda   @relation(fields: [venda_id], references: [venda_id])
  Produto        Produto @relation(fields: [produto_id], references: [produto_id])
}
